### 이 장에서 학습할 최적화 기법
- 이미지 사이즈 최적화 - 로딩성능 최적화
- 코드 분할 - 로딩성능 최적화
- 텍스트 압축 - 로딩성능 최적화
- 병목 코드 최적화 - 렌더링 성능 최적화

https://github.com/performance-lecture 에서 다운받은 코드로 학습 진행

## Lighthouse 툴을 이용한 검사

### Lighthouse로 검사하기

**Mode**
- Navigation : Lighthouse의 기본 값으로, 초기 페이지 로딩 시 발생하는 성능 문제를 분석
- Timespan : 사용자가 정의한 시간 동안 발생한 성능 문제를 분석
- Snapshot : 현재 상태의 성능 문제를 분석

**Categories**
- Performance : 웹 페이지의 로딩 과정에서 발생하는 성능 문제를 분석
- Accessibility : 서비스의 사용자 접근성 문제를 분석
- Best practices : 웹사이트의 보안 측면과 웹 개발의 최신 표준에 중점을 두고 분석
- SEO : 검색 엔진에서 얼마나 잘 크롤링되고 검색 결과에 표시되는지 분석
- Progressive Web App : 서비스 워커와 오프라인 동작 등, PWA와 관련된 문제를 분석

Navigation, Desktop, Performance를 체크하고 검사를 시작하면 된다.

### Lighthouse 검사 결과
![[Pasted image 20240311151327.png]]

가장 위에 있는게 아래 지표들의 가중치를 적용해 평균 낸 종합 점수이다. 이런 지표들을 웹 바이탈(Web Vital)이라고 부른다.

**First Contentful Paint(FCP)**
FCP는 페이지가 로드될 때 브라우저가 DOM 콘텐츠의 첫 번째 부분을 렌더링 하는 데 걸리는 시간에 관한 지표이다. 위 결과에서 페이지에 진입하여 첫 콘텐츠가 뜨기까지 0.8초가 걸렸음을 알 수 있다. FCP는 총점 계산시 10%의 가중치를 갖는다.

**Speed Index(SI)**
SI는 페이지 로드 중에 콘텐츠가 시각적으로 표시되는 속도를 나타내는 지표이다. 웹페이지 두 개가 각각 로드되는데 4초가 걸려다고 하더라도, 일부 콘텐츠가 먼저 뜨면 더 높은 점수를 받는다. SI는 총점 계산시 10%의 가중치를 받는다.

**Largest Contentful Paint(LCP)**
LCP는 페이지 로드시 화면 내에 있는 가장 큰 이미지나 텍스트 요소가 렌더링되기까지 걸리는 시간을 나타내는 지표이다. 위 결과에서 가장 큰 콘텐츠가 뜨기까지 1.9초가 걸렸음을 알 수 있다. 총점 계산시 25%의 가중치를 갖는다.

~~**Time To Interactive(TTI)**~~
 사용자가 페이지와 상호 작용이 가능한 시점까지 걸리는 시간을 측정한 지표이다. 여기서 상호 작용이란 클릭 또는 키보드 누름 같은 사용자 입력을 의미한다. TTI는 총점을 계산할 때 10%를 갖는다.
 => lighthouse 10부터 사라졌다. TTI보다는 LCP와 SI에 더 신경쓰도록 하기 위해서 라고 한다.

**Total Blocking Time(TBT)**
TBT는 페이지가 클릭, 키보드 입력 등의 사용자 입력에 응답하지 않도록 차단된 시간을 총합한 지표이다. 측정은 FCP와 TTI사이의 시간 동안 일어나며 메인 스레드를 독점하여 다른 동작을 방해하는 작업에 글린 시간을 계산한다. 총점 계산시 가중치 30%를 차지한다.

**Cumulative Layout Shift(CLS)**
CLS는 화면 로드 과정에서 발생하는 예기치 못한 레이아웃 이동을 측정한 지표이다. 레이아웃 이동이란 화면상에서 요소의 위치나 크기가 순간적으로 변하는 것을 말한다. CLS는 총점 계산시 15% 가중치를 갖는다.

이후 하단에는 `DIAGNOSTIC`이라고 하여 로드 속도와 직접적인 관계는 없지만 성능과 관련된 기타 정보를 보여 준다. 


![[Pasted image 20240311162235.png]]
마지막으로 Lighthouse 결과의 가장 하단에서는 검사 환경을 확인할 수 있다. 여기서 주의 깊게 살펴볼 만한 항목은 Emulated Desktop과 Custom throttling이다. 

![[Pasted image 20240311162259.png]]

`Emulated Desktop`추가 정보에서는 CPU throttling이란 정보를 확인할 수 있는데, 이는 기기(컴퓨터)의 성능을 어느 정도로 제한하여 검사를 진행했는지를 나타낸다. 첫 번째 사진에서는 는 1x로 되어있기 때문에 CPU 성능에 제한을 두지 않고 검사했음을 알 수 있다.

`Custom throttling`에는 Network throttling이라는 정보가 있다. 이는 네트워크 속도를 제한하여 어느 정도 고정된 네트워크 환경에서 성능을 측정했다는 의미로, 여기서 10,240 kbps로 네트워크 속도를 제한한 것을 알 수 있다. 

바로 이 두 가지 제한 때문에 Lighthouse 없이 그냥 페이지를 로드하는 것보다 Lighthouse를 이용할 때 속도가 더 느린 것이다.  






























